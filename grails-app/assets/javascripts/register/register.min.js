
$.login="/login/auth";$.validEmail="/register/validEmail";$.passwordRecovery="/register/forgotPassword";$(document).ready(function(){$("#updatePassword-btn").on("click",function(a){a.preventDefault();validateNewPassword()});$("#recoveryPassword-btn").on("click",function(a){a.preventDefault();$("#successMessage-div").html("");$("#errorMessage-div").html("");$("#successMessage-div").addClass("hidden");$("#errorMessage-div").addClass("hidden");validateForm()});$("#cancelPasswordRecovery-btn").on("click",function(a){a.preventDefault();window.location.href=$.login})});function validateNewPassword(){var a=0;$('p[class*="help-block"]').each(function(){$(this).remove()});if($("#password").val().trim()===""){a++;errorMessage($("#password"),"El campo es obligatorio")}else{if(!validatePassword($("#password").val().trim())){a++;errorMessage($("#password"),"La contraseña debe contener mínimo 8 y máximo 12 caracteres, al menos una letra mayúscula, una letra minúscula, un número y un caracter especial")}else{if($("#password").val().trim()!==$("#confirm-password").val().trim()){a++;errorMessage($("#confirm-password"),"Las contraseñas no coinciden")}}}if(a===0){$("#updatePassword").submit()}}function validateForm(){var a=0;$('p[class*="help-block"]').each(function(){$(this).remove()});if($("#email").val().trim()===""){a++;errorMessage($("#email"),"El campo es obligatorio")}else{if(!validateEmail($("#email").val().trim())){a++;errorMessage($("#email"),"Tu dirección de correo es incorrecta, verifica la estructura. Ej. ejemplo@mail.com")}else{validEmail(function(b){if(b.estatus===false){errorMessage($("#email"),"La dirección de correo electrónico no ha sido registrada")}else{if(b.estatus==="ERROR"){errorMessage($("#email"),"Ocurrió un error al validar la cuenta de correo electrónico. Inténtalo más tarde")}else{if(b.estatus===true){sendRequest()}}}})}}}function errorMessage(a,b){a.closest(".control").before("<p class='help-block marginRight25'><small style='color: red;'>"+b+"</small></p>")}function validEmail(a){$.ajax({type:"POST",dataType:"json",url:$.validEmail,data:"email="+$("#email").val().trim(),cache:false,success:function(b){a(b)},error:function(c,e,d){var b={estatus:"ERROR"};a(b)}})}function sendRequest(){$.ajax({type:"POST",dataType:"json",url:$.passwordRecovery,data:"email="+$("#email").val().trim(),beforeSend:function(b,a){$("body").mLoading({text:"Enviando solicitud, espere por favor...",icon:"/images/spinner.gif",mask:true})},success:function(a){cargaCompletada();if(a.error===true){$("#errorMessage-div").html(a.message);$("#errorMessage-div").removeClass("hidden")}else{$("#recoverPassword")[0].reset();$("#successMessage-div").html(a.message);$("#successMessage-div").removeClass("hidden")}},error:function(a,c,b){cargaCompletada();$("#errorMessage-div").html("Algo salió mal, intenta nuevamente en unos minutos.");$("#errorMessage-div").removeClass("hidden")}})}function cargaCompletada(){setTimeout(function(){$("body").mLoading("hide")},1000)};